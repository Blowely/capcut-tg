generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String    @id @default(cuid())
  telegramId    String    @unique
  username      String?
  firstName     String?
  lastName      String?
  photoUrl      String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  
  projects      Project[]
  
  @@map("users")
}

model Project {
  id            String    @id @default(cuid())
  title         String
  description   String?
  thumbnail     String?
  duration      Float?
  userId        String
  status        ProjectStatus @default(DRAFT)
  settings      Json?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  
  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  videos        Video[]
  assets        Asset[]
  
  @@map("projects")
}

model Video {
  id            String    @id @default(cuid())
  projectId     String
  filename      String
  originalName  String
  path          String
  url           String?
  mimeType      String
  size          Int
  duration      Float?
  width         Int?
  height        Int?
  fps           Float?
  codec         String?
  metadata      Json?
  status        VideoStatus @default(PROCESSING)
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  
  project       Project   @relation(fields: [projectId], references: [id], onDelete: Cascade)
  
  @@map("videos")
}

model Asset {
  id            String    @id @default(cuid())
  projectId     String
  type          AssetType
  filename      String
  originalName  String
  path          String
  url           String?
  mimeType      String
  size          Int
  duration      Float?
  metadata      Json?
  createdAt     DateTime  @default(now())
  
  project       Project   @relation(fields: [projectId], references: [id], onDelete: Cascade)
  
  @@map("assets")
}

enum ProjectStatus {
  DRAFT
  PROCESSING
  COMPLETED
  FAILED
}

enum VideoStatus {
  UPLOADING
  PROCESSING
  READY
  FAILED
}

enum AssetType {
  AUDIO
  IMAGE
  FONT
  STICKER
}



